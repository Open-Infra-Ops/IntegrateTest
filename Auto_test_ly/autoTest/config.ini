# 指定列表中的元素序号
GETTING_INDEX = [0, 2, 3, 5, 7]
import yagmail
from prettytable import PrettyTable

# 创建PrettyTable对象
table = PrettyTable()

# 设置列名
table.field_names = ["姓名", "年龄", "城市"]

# 添加数据行
table.add_row(["Alice", 30, "New York"])
table.add_row(["Bob", 25, "Boston"])
table.add_row(["Charlie", 35, "San Francisco"])

# 格式化表格以便于邮件正文
html_table = table.get_html_string()

# 配置邮件发送参数
yag = yagmail.SMTP(host='smtp.example.com', user='username@example.com', password='your_password', smtp_ssl=True)

# 邮件接收者
to = 'recipient@example.com'

# 邮件主题
subject = 'Table Email Example'

# 邮件内容
contents = [f'Subject: {subject}', html_table]

# 发送邮件
yag.send(to=to, subject=subject, contents=contents)